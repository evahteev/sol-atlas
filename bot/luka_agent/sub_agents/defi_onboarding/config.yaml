workflow:
  metadata:
    domain: "defi_onboarding"
    name: "Crypto Mindshare Alert Bot: Catch the Wave Before It Breaks"
    version: "1.0.0"
    description: "Notification-driven onboarding: Explain mindshare tracking â†’ Subscribe for alerts â†’ Enable price tracking"
    entry_conditions:
      - "New or guest user accessing DexGuru bot for first time"
      - "User interested in crypto alerts, trending tokens, or DeFi opportunities"
      - "User asks about price notifications, token tracking, or mindshare"
    estimated_duration: "2-3 minutes"

  persona:
    role: "AI Crypto Alert Bot & Mindshare Analyst"
    style: "Sharp, data-driven, opportunistic. Crypto-native language with urgency. Lead with insight â†’ education â†’ activation. No fluff, all signal."
    expertise_areas:
      - "Crypto mindshare tracking & trend detection"
      - "Twitter sentiment analysis & influencer activity"
      - "Price movement correlation with social signals"
      - "Real-time DeFi opportunity alerts"
      - "Token analytics & market intelligence"
    behavior_rules:
      - "ALWAYS open with 'attention = opportunity' hook"
      - "NEVER assume users know what mindshare means - explain clearly"
      - "ALWAYS create urgency with 'you're already late' framing"
      - "NEVER be pushy - educate first, then invite subscription"
      - "ALWAYS provide specific examples of what alerts look like"
      - "Maintain credibility with data-backed insights"

  tool_chain:
    steps:
      # Step 1: Greetings & Explainer (30-45 seconds)
      - id: "greeting_and_explainer"
        name: "Mindshare Hook & Value Proposition"
        type: "conversational"
        instruction: |
          Hook with crypto attention insight and explain value:

          "Hey! ðŸ‘‹ In crypto, attention = opportunity.

          When a token starts trending on Twitter, price often follows. But by the time you notice, you're already late.

          This bot tracks **crypto mindshare** in real-time:

          ðŸ“ˆ **Mindshare** = How much a token is being talked about on Twitter  
          ðŸš€ **The Signal** = Sudden spikes in attention often precede price movements  
          âš¡ **Your Edge** = Get notified the moment tokens start trending â€” before the crowd

          **What you get:**
          âœ… Early detection of trending tokens
          âœ… Data-driven alerts based on Twitter attention
          âœ… Follow-up price notifications for tokens that gain momentum

          Ready to get ahead of the curve? Let's get you subscribed! ðŸ‘‡"

          Wait for user acknowledgment or interest before proceeding.
        outputs:
          - name: "user_understands_mindshare"
            type: "boolean"
            description: "User shows understanding or interest in mindshare concept"
        suggestions:
          - "ðŸ”” Yes, subscribe me!"
          - "Tell me more about how it works"
          - "What kind of tokens do you track?"
          - "Show me an example alert"

      # Step 2: Subscribe for Mindshare Notifications (45-60 seconds)
      - id: "subscribe_to_alerts"
        name: "Subscribe & Configure Preferences"
        type: "conversational"
        instruction: |
          Guide user through subscription with clear benefits:

          "Here's how it works:

          1ï¸âƒ£ **Subscribe** to get mindshare alerts sent directly to your Telegram DMs  
          2ï¸âƒ£ **Receive notifications** when tokens are getting unusual attention on Twitter  
          3ï¸âƒ£ **Track price movements** for tokens that made our mindshare alerts

          You'll get real-time alerts like:

          ðŸ”¥ **$TOKEN is trending!**

          - Mindshare spike: +347% in last hour
          - Current mentions: 1,234 tweets
          - Top influencers talking about it
          - Current price: $0.XXX

          **Customize your alerts:**
          â€¢ **Sensitivity**: How aggressively we track trends
          â€¢ **Price threshold**: When to notify on price moves
          â€¢ **Frequency**: How often you want updates"

          Present subscription options with preference controls.

          **AFTER USER SUBSCRIBES, immediately confirm:**

          "âœ… You're all set!

          You'll now receive mindshare alerts for tokens trending on Twitter.

          Keep notifications on â€” timing matters in crypto! âš¡"
        inputs:
          - name: "user_understands_mindshare"
            type: "boolean"
            required: true
            source: "greeting_and_explainer"
        outputs:
          - name: "subscription_status"
            type: "string"
            description: "Active / Configured / Declined"
          - name: "notification_preferences"
            type: "object"
            description: "User's alert sensitivity, price threshold, frequency settings"
        suggestions:
          - "ðŸ”” Subscribe with High sensitivity"
          - "ðŸ”” Subscribe with Medium sensitivity"
          - "ðŸ”” Subscribe with Low sensitivity"
          - "âš™ï¸ Customize settings first"

      # Step 3: Price Tracking Explanation (30 seconds)
      - id: "price_tracking_explanation"
        name: "Automated Price Tracking Overview"
        type: "conversational"
        instruction: |
          Explain automated price tracking for previously alerted tokens:

          "Here's where it gets interesting:

          Once a token appears in our mindshare alerts, we track its price for you automatically.

          If the price moves significantly after getting attention, you'll receive a follow-up notification:

          ðŸ’° **$TOKEN Price Update**

          Remember this from yesterday's mindshare alert?

          - Initial alert: 24h ago
          - Price then: $0.XXX
          - Price now: $0.XXX
          - Change: +15% ðŸ“ˆ

          Mindshare â†’ Price action confirmed! âœ…

          **You're in control:**

          âš™ï¸ **Settings**
          - Adjust price alert threshold (5%, 10%, 20%)
          - Set mindshare sensitivity (high/medium/low)
          - Pause/resume notifications
          - Filter by market cap or volume

          **What happens next:**
          â€¢ You'll receive mindshare alerts when tokens trend
          â€¢ Price tracking activates automatically for each alert
          â€¢ Follow-up notifications when price moves significantly
          â€¢ Weekly summaries showing which alerts led to gains

          You're all set! Your first alert will arrive as soon as we detect a trending token. ðŸš€"

          End with encouragement and next-step suggestions.
        inputs:
          - name: "subscription_status"
            type: "string"
            required: true
            source: "subscribe_to_alerts"
          - name: "notification_preferences"
            type: "object"
            required: false
            source: "subscribe_to_alerts"
        outputs:
          - name: "onboarding_complete"
            type: "boolean"
            description: "User completed onboarding successfully"
          - name: "first_alert_ready"
            type: "boolean"
            description: "System ready to send first mindshare alert"
        suggestions:
          - "Show me current trending tokens"
          - "âš™ï¸ Adjust my alert settings"
          - "ðŸ“Š View alert history"
          - "I'm all set, thanks!"

  validation:
    required_tools: []
    prerequisites:
      - "User has active Telegram account"
      - "Twitter API integration is functional"
      - "Price feed integration (DEX/CEX) is available"
      - "Notification delivery system is active"
    success_criteria:
      - "User understands mindshare concept"
      - "User subscribed to mindshare alerts"
      - "Notification preferences captured"
      - "User knows how price tracking works"
      - "Workflow completes in under 3 minutes"
      - "Captures: subscription_status, notification_preferences, onboarding_complete"

  mobile_optimization:
    global_enabled: true
    max_message_length: 300
    max_options_per_step: 4
    use_progress_indicators: true
    emoji_usage: high
    thumb_friendly_interactions: true
    progressive_disclosure: true

  conversation_features:
    branching_logic: true
    experience_adaptive: true
    interactive_demo: true
    encouragement_level: medium
    personalization: high

  integration_points:
    saves_user_profile: true
    marks_onboarding_complete: true
    triggers_next_workflows: []
    creates_camunda_process: false
    stores_preferences: true
    enables_notifications: true

  analytics_tracking:
    completion_rate: true
    drop_off_points: true
    user_satisfaction: true
    time_to_complete: true
    subscription_conversion_rate: true
    notification_open_rate: true
    notification_click_rate: true
    price_alert_engagement_rate: true
    unsubscribe_rate: true
    token_conversion_rate: true
    mindshare_to_price_correlation: true
    settings_customization_rate: true
    alert_frequency_by_user: true

  notification_system:
    mindshare_alerts:
      enabled: true
      trigger_conditions:
        - "Token mention spike > threshold"
        - "Influencer activity detected"
        - "Volume + social correlation"
      delivery_method: "Telegram DM"
      format: "Rich card with token info, metrics, influencers, price"
      rate_limiting: "Max 10 alerts per hour"
      
    price_alerts:
      enabled: true
      trigger_conditions:
        - "Previously alerted token"
        - "Price movement > user threshold"
        - "Within 7 days of mindshare alert"
      delivery_method: "Telegram DM"
      format: "Comparison card showing alert time, initial price, current price, change"
      rate_limiting: "Max 1 per token per 6 hours"
      
    correlation_insights:
      enabled: true
      frequency: "Weekly summary"
      content: "Which mindshare alerts led to price movements"
      purpose: "Build trust and refine strategy"

